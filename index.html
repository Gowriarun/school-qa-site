<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>St. Maryâ€™s Fujairah â€“ Parent Q&A</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{--p:#3b5bdb;--bg:#f8f9ff;--card:#fff;--muted:#666}
body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg)}
header{padding:24px;background:linear-gradient(180deg,#eef1ff,transparent);border-bottom:1px solid #eef}
header h1{margin:0 0 8px} header p{margin:0;color:var(--muted)}
main{max-width:980px;margin:24px auto 120px;padding:0 16px}
.card{background:var(--card);border:1px solid #eee;border-radius:16px;padding:18px;margin-bottom:14px}
.tight{margin:8px 0 0 18px}
#chatBtn{position:fixed;right:24px;bottom:24px;background:var(--p);color:#fff;border:none;border-radius:999px;padding:14px 18px;font-weight:700;box-shadow:0 10px 28px rgba(59,91,219,.35);cursor:pointer}
#panel{position:fixed;right:24px;bottom:92px;width:min(420px,calc(100vw - 32px));height:560px;display:none;background:#fff;border:1px solid #e6e9ff;border-radius:18px;box-shadow:0 18px 56px rgba(59,91,219,.25);overflow:hidden}
#hdr{padding:10px 14px;background:#f4f6ff;border-bottom:1px solid #e6e9ff}
#chat{height:calc(100% - 56px - 60px);overflow:auto;padding:12px;display:flex;flex-direction:column;gap:10px;background:#fcfcff}
.bubble{max-width:85%;padding:12px 14px;border-radius:14px;border:1px solid #eef}
.me{margin-left:auto;background:#eef2ff}
#form{display:flex;gap:8px;padding:10px;border-top:1px solid #e6e9ff;background:#fff}
#q{flex:1;padding:12px;border:1px solid #dfe3f9;border-radius:12px}
#send{background:var(--p);color:#fff;border:none;border-radius:12px;padding:0 16px;font-weight:700}
.kicker{color:var(--muted);font-size:12px;margin-top:6px}
</style>
</head>
<body>
<header>
  <h1>St. Maryâ€™s Catholic High School, Fujairah</h1>
  <p>Parent information & friendly Q&A assistant</p>
</header>

<main>
  <section class="card">
    <h2>Quick info</h2>
    <ul class="tight">
      <li>UK British Curriculum; Pearson Edexcel centre (GCSE/IGCSE â†’ IAS â†’ IAL). Medium of instruction: English.</li>
      <li>Arabic mandatory G1â€“9 (Arabs compulsory till G12). Islamic compulsory for Muslims G1â€“12.</li>
      <li>Fees per year (AED): KG1â€“2 7,270 | G1â€“3 8,100 | G4â€“6 9,100 | G7â€“8 11,200 | G9â€“10 13,100 | G11â€“12 15,900.</li>
      <li>Admissions: KG age rule; G1â€“9 entrance tests (Eng & Math ~1 hr each). No new admittance to G10.</li>
    </ul>
  </section>
</main>

<button id="chatBtn">Chat with us ðŸ’¬</button>
<section id="panel" aria-live="polite">
  <div id="hdr"><strong>Parent Q&A Assistant</strong></div>
  <div id="chat"></div>
  <form id="form">
    <input id="q" placeholder="Ask anything: fees, admissions, subjects, documentsâ€¦" autocomplete="off">
    <button id="send" type="submit">Send</button>
  </form>
</section>

<!-- Knowledge Base (expand anytime) -->
<script id="kb" type="application/json">
{
  "admissions": {
    "kg_age_rule": "KG1/KG2 applicants must be four years old on/before Aug 31 for September start.",
    "grade_tests": "Entrance test in English and Mathematics (~1 hour each) for Grades 1â€“9. Seats are competitive if applicants exceed availability.",
    "no_grade10": "No new admissions to Grade 10 as students prepare for the London Board exams.",
    "grade11": "Enrollment opens after Oâ€™Level/Grade 10 results. For UK curriculum students who have passed Board Exams with a minimum of A*/A (9â€“7).",
    "grade12": "Admission to Grade 12 (IAL) is restricted to students who completed IAS with a minimum grade of A and B.",
    "docs_required": [
      "Childâ€™s passport + valid visa page",
      "Birth certificate",
      "Vaccination card (KG1/2 and Grade 1)",
      "Emirates ID",
      "Six passport-size photos",
      "Latest report card & reference letter from previous school",
      "Attested Transfer/School Leaving Certificate (from previous school)",
      "Bonafide certificate (for Grade 1â€“8 transfers)",
      "Medical record book (from previous school)",
      "Family book (UAE nationals only)"
    ],
    "transfer_notes": [
      "Within UAE: certificates must be attested by the Ministry of Education in the concerned Educational Zone.",
      "From abroad: certificates must be attested by the regional education office, the countryâ€™s Embassy/Consulate in the UAE, and the UAE Ministry of Foreign Affairs."
    ]
  },
  "fees_per_year_aed": {
    "KG1-2": 7270, "G1-3": 8100, "G4-6": 9100, "G7-8": 11200, "G9-10": 13100, "G11-12_Alevel": 15900
  },
  "curriculum": {
    "board": "Pearson Edexcel centre (GCSE/IGCSE, IAS, IAL).",
    "medium": "English",
    "arabic_islamic": "Arabic mandatory for all students in Grades 1â€“9 (and compulsory for Arabs through Grade 12). Islamic Studies is compulsory for Muslim students in Grades 1â€“12."
  },
  "subjects": {
    "grade9_minimum": "Minimum 9 subjects in Grade 9.",
    "pairs": ["Chemistry or Accounts", "Physics or Economics", "Biology or Business Studies"],
    "igcse_optional": ["English Literature", "ICT", "Global Citizenship or Urdu", "Chemistry", "Physics", "Biology or Business Studies"],
    "a_level": ["Math", "Physics or Economics", "Chemistry or Accounts", "Biology or Business Studies", "Islam (English or Arabic)", "Higher/Lower Arabic"],
    "rules": [
      "Choose at least two Aâ€™ Level subjects (excluding Arabic & Islamic).",
      "Availability of options depends on number of students opting.",
      "Once chosen, subjects cannot be changed during the year; the school will inform parents if any adjustments are needed."
    ]
  },
  "equivalency_uae": [
    "Complete Grade 12 (or equivalent).",
    "Pass 5 subjects at the ordinary level (GCSE/IGCSE) with grades A*â€“D (or 9â€“3), including Mathematics, one science (Physics/Chemistry/Biology or dual science), and English Language or English Literature.",
    "Pass 2 subjects at the Advanced level (A-Level/IAS/IAL) with grades A*â€“E.",
    "Arabic & Islamic (at Oâ€™ and Aâ€™ levels) are not counted among the required equivalency subjects."
  ]
}
</script>

<script>
const WORKER_URL = "https://delicate-cake-3610.gowriarunn2008.workers.dev"; // no trailing slash
const btn = document.getElementById('chatBtn');
const panel = document.getElementById('panel');
const chat = document.getElementById('chat');
const form = document.getElementById('form');
const input = document.getElementById('q');
const kb = document.getElementById('kb').textContent;

const add = (t, who='bot') => { const b=document.createElement('div'); b.className='bubble'+(who==='me'?' me':''); b.textContent=t; chat.appendChild(b); chat.scrollTop=chat.scrollHeight; return b; };

btn.addEventListener('click', ()=>{
  panel.style.display = panel.style.display==='block' ? 'none' : 'block';
  if (panel.style.display==='block' && chat.childElementCount===0) {
    add("Hello! Iâ€™m the St. Maryâ€™s Parent Assistant ðŸ˜Š Ask me about admissions, fees, subjects, documents, or curriculum.");
  }
});

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const question = (input.value||"").trim();
  if (!question) return;
  add(question, 'me'); input.value='';
  const wait = add("Thinkingâ€¦");
  try {
    const r = await fetch(`${WORKER_URL}/api/ask`, {
      method: "POST",
      headers: { "Content-Type":"application/json" },
      body: JSON.stringify({ question, kb })
    });
    const data = await r.json();
    wait.remove();
    add(data.answer || "I donâ€™t have that in the official info. Please contact the school office.");
  } catch {
    wait.remove();
    add("Network hiccupâ€”please try again.");
  }
});
</script>
</body>
</html>
