<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>St. Mary‚Äôs Parent Assistant</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1222; --panel:#141833; --muted:#a9b1d6; --text:#e9edff;
      --bubble:#1b2250; --me:#2b377f; --accent:#6ea8ff; --border:rgba(255,255,255,.08);
      --ring:rgba(110,168,255,.25);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:radial-gradient(1200px 900px at 80% -10%, #1d2555 0%, #111432 45%, #0f1222 100%);
      font-family:Poppins,system-ui,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:16px}
    .card{
      width:min(960px,100%); height:min(82vh,820px);
      background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.02)),var(--panel);
      border:1px solid var(--border); border-radius:20px; overflow:hidden;
      display:grid; grid-template-rows:auto 1fr auto;
      box-shadow:0 30px 80px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.04) inset;
    }
    header{display:flex;align-items:center;gap:12px;padding:14px 16px;border-bottom:1px solid var(--border);
      background:linear-gradient(180deg,rgba(255,255,255,.04),transparent)}
    .logo{height:28px;width:28px;border-radius:8px;background:linear-gradient(135deg,#6ea8ff,#a28bff);box-shadow:0 0 0 4px rgba(110,168,255,.12)}
    .brand{font-weight:600;letter-spacing:.3px}
    .sub{margin-left:auto;color:var(--muted);font-size:12px}

    .chat{position:relative;overflow:auto;padding:18px;display:flex;flex-direction:column;gap:12px;scroll-behavior:smooth;background:
      radial-gradient(600px 260px at 10% -10%, rgba(110,168,255,.08), transparent 70%),
      radial-gradient(600px 260px at 110% 10%, rgba(162,139,255,.08), transparent 70%)}
    .bubble{max-width:min(78ch,86%);padding:12px 14px;border-radius:16px;line-height:1.55;font-size:15px;border:1px solid var(--border);
      background:var(--bubble);box-shadow:0 6px 24px rgba(0,0,0,.18)}
    .me{margin-left:auto;background:var(--me)}
    .bot{margin-right:auto}
    .hint{color:var(--muted);font-size:12px;margin-top:4px}
    .typing{display:inline-flex;gap:6px;align-items:center}
    .dot{width:6px;height:6px;border-radius:50%;background:#c9d5ff;opacity:.6;animation:blink 1.3s infinite}
    .dot:nth-child(2){animation-delay:.15s}.dot:nth-child(3){animation-delay:.3s}
    @keyframes blink{0%,80%,100%{opacity:.2}30%{opacity:.9}}

    .dock{padding:12px;border-top:1px solid var(--border);background:linear-gradient(0deg,rgba(255,255,255,.03),transparent);display:grid;gap:10px}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{background:transparent;border:1px solid var(--border);color:var(--muted);padding:8px 10px;border-radius:999px;font-size:12px;cursor:pointer}
    .chip:hover{border-color:#8fb7ff33;color:#d9e4ff;box-shadow:0 0 0 4px var(--ring)}
    .form{display:flex;gap:10px}
    input[type="text"]{flex:1;padding:14px;border-radius:12px;border:1px solid var(--border);background:#0f1330;color:var(--text);outline:none;font-size:15px}
    input[type="text"]::placeholder{color:#9aa3cf}
    input[type="text"]:focus{box-shadow:0 0 0 4px var(--ring);border-color:#8fb7ff33}
    button.send{padding:0 16px;border-radius:12px;border:1px solid #7aa7ff55;color:#0d122e;background:linear-gradient(135deg,#6ea8ff,#a28bff);
      font-weight:700;display:inline-flex;align-items:center;gap:8px;cursor:pointer;box-shadow:0 10px 26px rgba(110,168,255,.35)}
    button.send:disabled{opacity:.5;cursor:not-allowed}
    @media (max-width:720px){.card{height:calc(100vh - 24px)}.bubble{max-width:92%}header{padding:12px}.chat{padding:14px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="application" aria-label="St. Mary‚Äôs Parent Assistant">
      <header>
        <span class="logo" aria-hidden="true"></span>
        <div class="brand">St. Mary‚Äôs Parent Assistant</div>
        <div class="sub">Admissions ‚Ä¢ Fees ‚Ä¢ Subjects ‚Ä¢ Policies</div>
      </header>

      <main id="chat" class="chat" tabindex="0" aria-live="polite">
        <div class="bubble bot">
          Hi! I‚Äôm the St. Mary‚Äôs Parent Assistant üòä<br/>
          Ask me about <b>admissions</b>, <b>fees</b>, <b>subjects</b>, required documents, timings, or policies.
          <div class="hint">Try: ‚ÄúDocuments for admission‚Äù, ‚ÄúFees for Grade 11‚Äù, ‚ÄúA‚Äô Level subjects‚Äù, ‚ÄúSchool timings‚Äù.</div>
        </div>
      </main>

      <div class="dock">
        <div class="chips" id="chips">
          <button class="chip" data-q="What documents are required for admissions?">Documents</button>
          <button class="chip" data-q="Fees for Grade 11">Fees (G11)</button>
          <button class="chip" data-q="What are the school timings?">School timings</button>
          <button class="chip" data-q="Who is the principal?">Principal</button>
          <button class="chip" data-q="Where do I buy the uniform?">Uniform</button>
        </div>
        <form id="form" class="form" autocomplete="off">
          <input id="q" type="text" placeholder="Type your question‚Ä¶" required />
          <button id="send" class="send" type="submit" aria-label="Send">Send ‚Üó</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Set your Worker URL -->
  <script>
    const WORKER_URL = "https://delicate-cake-3610.gowriarunn2008.workers.dev/api/ask"; // ‚Üê change if different
  </script>

  <!-- Knowledge Base (complete) -->
  <script id="kb" type="application/json">
{
  "school": {
    "name": "St. Mary‚Äôs Catholic High School, Fujairah",
    "location": "Fujairah, UAE",
    "motto": "The End Crowns the Work",
    "leadership": {
      "sponsor": "H.E. Dr. Mohamed Saeed Al Kindi",
      "owner": "His Excellency Bishop Paolo Martinelli",
      "managing_director": "Mr. Joseph Flynn",
      "principal": "Fr. Suresh Kumar SDB"
    }
  },

  "contact": {
    "postal_address": "St. Mary‚Äôs Catholic High School, P.O. Box: 1665, Fujairah, UAE",
    "phone": "09-2282828",
    "fax": "09-2281910",
    "email": "secretary.principal-smf@smgeducation.org",
    "note": "If your question isn‚Äôt covered, please contact the school office and we‚Äôll be happy to help."
  },

  "timings": {
    "monday_thursday": "07:40 AM ‚Äì 02:05 PM",
    "friday": "07:25 AM ‚Äì 11:20 AM",
    "weekend": "Closed (Sat‚ÄìSun)"
  },

  "vision": "To prepare innovative global leaders and realize the National Agenda by providing holistic, inclusive, quality and sustainable education.",
  "mission": [
    "Ensure academic excellence via continuous assessment, research, innovation and discovery.",
    "Respect UAE culture and values.",
    "Value-based learning delivered by committed, qualified staff.",
    "Cater to differing abilities via competency-based teaching.",
    "Humanitarian values and responsibility.",
    "Strong parent & stakeholder collaboration."
  ],

  "admissions": {
    "apply": "Parents should visit the school or contact the Admissions Officer to apply. We‚Äôll guide you through the steps and schedule any placement tests if required.",
    "kg_age_rule": "KG1/KG2 applicants must be four years old on/before August 31 for September start.",
    "grade_tests": "Grades 1‚Äì9 require a placement/entrance test in English & Mathematics (~1 hour each). Admission is competitive when applicants exceed seats.",
    "no_grade10": "No new admissions to Grade 10 as students prepare for London Board exams.",
    "grade11": "Enrollment starts in August after O‚Äô/Grade 10 results. For UK curriculum students who passed Board Exams with minimum A*/A (9‚Äì7).",
    "grade12": "Admission to Grade 12 (IAL) is for students who completed IAS with minimum grades A and B.",
    "a_level_enrollment": "For A‚Äô Level, students should have O‚ÄôLevel/Grade 10 with six subjects including English and Mathematics and Grade A in the chosen A‚Äô subjects.",
    "results_contact": "Only selected applicants will be contacted with registration details and timelines.",
    "subject_change_policy": "Once subject choices are made, they cannot be changed or dropped during the year. Changes are only considered right at the start and only if the administration advises parents.",
    "docs_required": [
      "Child‚Äôs passport + visa page",
      "Birth certificate",
      "Vaccination card (KG1/2 & Grade 1)",
      "Emirates ID",
      "Six passport photos",
      "Latest report card + reference letter from previous school",
      "Attested Transfer/School Leaving Certificate",
      "Bonafide certificate (Grade 1‚Äì8)",
      "Medical record book",
      "Family book (UAE nationals only)"
    ],
    "transfer_notes": [
      "Within UAE: attest certificates at the MoE in the concerned Educational Zone.",
      "From abroad: attest at (1) Regional Education Office, (2) your country‚Äôs Embassy/Consulate in the UAE, and (3) UAE Ministry of Foreign Affairs."
    ]
  },

  "fees_per_year_aed": {
    "KG1-2": 7270,
    "G1-3": 8100,
    "G4-6": 9100,
    "G7-8": 11200,
    "G9-10": 13100,
    "G11-12_Alevel": 15900,
    "installments_note": "Fees are paid in three installments. For exact term amounts and due dates, please check with the Accounts Office."
  },

  "payments": {
    "methods": "Fees can typically be paid via cash, cheque or bank transfer. Please confirm the available options and bank details with the Accounts Office.",
    "late_penalties": "Late payment penalties may apply according to school policy. Contact Accounts for current details.",
    "sibling_discount": "Sibling discounts may be available. The Accounts Office can confirm current eligibility and rates.",
    "reregistration": "Returning students pay a re-registration fee to confirm their seat for the next academic year; timelines are announced by the office."
  },

  "curriculum": {
    "board": "UK British Curriculum; Pearson Edexcel centre.",
    "stages": [
      "EYFS",
      "Gr2‚Äì5 International Primary",
      "Gr6‚Äì8 KS3 Lower Secondary",
      "Gr9‚Äì10 GCSE/IGCSE",
      "Gr11 IAS",
      "Gr12 IAL"
    ],
    "medium": "English",
    "arabic_islamic": "Arabic is mandatory in Grades 1‚Äì9 (and compulsory for Arabs until Grade 12). Islamic Studies is compulsory for Muslim students from Grade 1‚Äì12.",
    "secondary_notes": [
      "From Grade 9 students prepare for IGCSE/GCSE and later IAS/IAL.",
      "Subject concentration (science or arts/commerce) begins in Grade 9, finalized at the end of Grade 8."
    ]
  },

  "subjects": {
    "grade9_minimum": "Minimum 9 subjects in Grade 9.",
    "gcse_compulsory": [
      "English Language (IGCSE)",
      "Religious/Islamic Studies (per MoE; exam options available for Religious & Islamic Studies in English)",
      "Social Studies (until Grade 9)",
      "Mathematics (IGCSE)",
      "Higher/Lower Arabic",
      "MEP (Arabic/English) compulsory until Grade 12 (Arabic is compulsory for Arabs until Grade 12; Arabic board exam available as GCSE)"
    ],
    "gcse_optional": [
      "English Literature (IGCSE)",
      "ICT (IGCSE)",
      "Global Citizenship (IGCSE) or Urdu (GCSE)"
    ],
    "pairs": [
      "Chemistry or Accounts",
      "Physics or Economics",
      "Biology or Business Studies"
    ],
    "rules": [
      "Choose subjects according to the requirements of your destination university and country.",
      "Class availability depends on sufficient numbers opting.",
      "Once choices are made, the subject cannot be changed/dropped during the year."
    ],
    "a_level": [
      "Math",
      "Physics or Economics",
      "Chemistry or Accounts",
      "Biology or Business Studies",
      "Islam (English or Arabic)",
      "Higher/Lower Arabic"
    ],
    "a_level_rules": [
      "Choose at least two A‚Äô Level subjects (excluding Arabic & Islamic).",
      "For higher education in the UAE: Arabic is mandatory for all; Islamic is mandatory for Muslim students (MoE unified exams)."
    ]
  },

  "reports": {
    "collection": "A-Level / O-Level / AS-Level grades are collected from the Principal‚Äôs office. Lower grade report cards are distributed during Parent‚ÄìTeacher Meetings (PTM)."
  },

  "facilities": {
    "transport": "School transport is available on designated routes; seats are subject to availability and students must follow bus safety rules at all times.",
    "uniform": "Uniform is mandatory and available on campus at the bookstore near reception.",
    "canteen": "Yes, a canteen is available on campus."
  },

  "policies": {
    "attendance": [
      "Regular attendance is required; follow school timings strictly.",
      "Absences require a valid reason/medical note and should be communicated to the school.",
      "Excessive absence may affect promotion or exam eligibility in line with MoE guidelines."
    ],
    "leave": "To apply for leave, please submit a written leave letter to the class teacher.",
    "assessment_examination": [
      "Continuous assessment plus formal examinations as per Pearson Edexcel and MoE schedules.",
      "Academic honesty is expected; malpractice may lead to cancellation and disciplinary action."
    ],
    "homework": [
      "Homework reinforces classroom learning; submit assignments on time.",
      "Parents are encouraged to support routines and a quiet study environment."
    ],
    "promotion_retention": [
      "Promotion considers overall performance, assessments, attendance and conduct per school/MoE norms.",
      "Support plans/remedial classes may be advised before retention is considered."
    ],
    "uniform_discipline": [
      "Students must wear full school uniform and maintain a neat appearance; PE uniform on designated days.",
      "Respectful behavior is expected at all times; prohibited items or misconduct lead to disciplinary measures."
    ],
    "health_safety": [
      "Parents must disclose medical conditions and keep vaccination/records updated.",
      "Sick students should remain at home; report contagious conditions promptly.",
      "Child safeguarding procedures and emergency protocols are in place."
    ],
    "support_contact": "For academic support, the class teacher is your first contact; supervisors and counselors are also available."
  },

  "faqs": {
    "admissions": [
      {
        "q": "What are the admission requirements?",
        "a": "Admission requires a completed application, age-appropriate documents, and‚Äîwhere applicable‚Äîplacement tests. Bring passport, Emirates ID, birth certificate, vaccination record, previous report cards, and an attested Transfer Certificate if transferring."
      },
      {
        "q": "How do I apply?",
        "a": "Please visit the school or contact the Admissions Officer. We‚Äôll guide you through the steps, book placement tests if needed, and update you on seat availability."
      },
      {
        "q": "Is there an entrance exam?",
        "a": "Yes‚ÄîGrades 1‚Äì9 have placement tests in English and Mathematics (about one hour each). A‚Äô Level admission depends on prior results (O‚ÄôLevel/Grade 10 with six subjects incl. English & Math and Grade A in chosen A‚Äô subjects)."
      },
      {
        "q": "Can I transfer from another school?",
        "a": "Yes. You‚Äôll need an attested Transfer Certificate: within the UAE, by the MoE Educational Zone; from abroad, by the Regional Education Office, your country‚Äôs Embassy/Consulate in the UAE, and the UAE MOFA."
      },
      {
        "q": "How long does the process take?",
        "a": "Timelines vary by grade and seat availability. Once documents and tests are complete, selected applicants are contacted with registration details."
      }
    ],
    "fees": [
      {
        "q": "What is the fee structure?",
        "a": "Annual tuition (AED): KG1‚Äì2 7,270 ‚Ä¢ G1‚Äì3 8,100 ‚Ä¢ G4‚Äì6 9,100 ‚Ä¢ G7‚Äì8 11,200 ‚Ä¢ G9‚Äì10 13,100 ‚Ä¢ G11‚Äì12/A‚ÄôLevel 15,900. Fees are paid in three installments."
      },
      {
        "q": "How can I pay the fees?",
        "a": "You can typically pay via cash, cheque or bank transfer. Please check with the Accounts Office for current options and bank details."
      },
      {
        "q": "Are there late fees or sibling discounts?",
        "a": "Late payment penalties and sibling discounts may apply according to current policy. The Accounts Office can confirm eligibility and rates."
      },
      {
        "q": "Do I need to pay re-registration fees?",
        "a": "Yes‚Äîreturning students pay a re-registration fee to confirm their seat for the next year. Dates and amounts are announced by the office."
      }
    ],
    "academics": [
      {
        "q": "What curriculum do you follow?",
        "a": "We‚Äôre a Pearson Edexcel centre offering the UK British Curriculum: GCSE/IGCSE (Grades 9‚Äì10), IAS (Grade 11) and IAL (Grade 12). Medium of instruction is English. Arabic and Islamic Studies follow MoE requirements."
      },
      {
        "q": "What subjects are offered?",
        "a": "Core: English, Mathematics, Sciences. Options include ICT, English Literature, Global Citizenship or Urdu, and subject pairings (Chemistry or Accounts; Physics or Economics; Biology or Business Studies). A‚Äô Level options include Math; Physics or Economics; Chemistry or Accounts; Biology or Business Studies; Islam (English/Arabic); Higher/Lower Arabic."
      },
      {
        "q": "What are the school timings?",
        "a": "Mon‚ÄìThu: 07:40 AM ‚Äì 02:05 PM ‚Ä¢ Fri: 07:25 AM ‚Äì 11:20 AM ‚Ä¢ Weekend: Closed (Sat‚ÄìSun)."
      },
      {
        "q": "How are exams and grading done?",
        "a": "Assessment combines classwork, assignments, and formal examinations per Pearson Edexcel and MoE schedules. Academic honesty is mandatory."
      },
      {
        "q": "How do I collect report cards?",
        "a": "A-Level/AS/O-Level results can be collected from the Principal‚Äôs office. Lower grades receive report cards during PTM."
      },
      {
        "q": "Are extra classes or tutoring offered?",
        "a": "Extra help is provided where needed. If the class teacher identifies a gap, they‚Äôll advise on support and timings."
      }
    ],
    "general": [
      {
        "q": "Where is the school located and how do I contact you?",
        "a": "P.O. Box 1665, Fujairah, UAE ‚Ä¢ Phone: 09-2282828 ‚Ä¢ Fax: 09-2281910 ‚Ä¢ Email: secretary.principal-smf@smgeducation.org."
      },
      {
        "q": "Who is the Principal?",
        "a": "Our Principal is Fr. Suresh Kumar SDB."
      },
      {
        "q": "Is transportation available?",
        "a": "Yes, on designated routes. Seats are limited and safety rules must be followed. Route details are provided during admission."
      },
      {
        "q": "What are the rules & regulations?",
        "a": "Key expectations: punctuality and attendance, neat full uniform, respectful behavior, academic honesty, and compliance with MoE/Edexcel exam rules."
      }
    ],
    "student_life": [
      {
        "q": "Do you have extracurricular activities and clubs?",
        "a": "Yes‚Äîcultural, academic and recreational activities run throughout the year. Notices are sent to parents each term."
      },
      {
        "q": "What sports are offered?",
        "a": "Core offerings include football, basketball and athletics. Opportunities may vary by term and grade."
      },
      {
        "q": "Is there a school uniform? Where do I buy it?",
        "a": "Uniform is mandatory. You can purchase it on campus at the bookstore near reception."
      },
      {
        "q": "Is there a canteen?",
        "a": "Yes, a canteen is available on campus."
      }
    ],
    "policies_faq": [
      {
        "q": "What is the attendance policy?",
        "a": "Regular attendance is expected. Absences require a valid reason/medical note. Excess absence can affect promotion or exam eligibility."
      },
      {
        "q": "How do I apply for leave?",
        "a": "Please send a written leave letter to the class teacher with the student‚Äôs name, grade, dates and reason."
      },
      {
        "q": "What is your stance on bullying?",
        "a": "We maintain a zero-tolerance policy. Concerns should be reported immediately to the class teacher or school office for prompt action and support."
      },
      {
        "q": "Can I drop or change subjects in Grade 9?",
        "a": "Grade 9 requires a minimum of 9 subjects. Once choices are made, subjects cannot be changed or dropped during the year. Changes are only considered right at the start and only if the administration advises parents. If you plan to transfer next year, discuss options with the Academic Supervisor before term starts."
      }
    ]
  }
}
</script>

  <script>
  const chat = document.getElementById('chat');
  const form = document.getElementById('form');
  const input = document.getElementById('q');
  const chips = document.getElementById('chips');
  const KB = document.getElementById('kb').textContent;

  function addBubble(text, me=false){
    const b=document.createElement('div');
    b.className='bubble ' + (me?'me':'bot');
    b.innerHTML=text.replace(/\n/g,'<br>');
    chat.appendChild(b); chat.scrollTop=chat.scrollHeight; return b;
  }
  let typingEl=null;
  function showTyping(){ typingEl=document.createElement('div'); typingEl.className='bubble bot';
    typingEl.innerHTML=`<span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>`;
    chat.appendChild(typingEl); chat.scrollTop=chat.scrollHeight; }
  function hideTyping(){ if(typingEl){typingEl.remove(); typingEl=null;} }

  // session memory (very light)
  const history = []; // {role, content}
  const profile = JSON.parse(localStorage.getItem("smchs_profile") || "{}");
  function rememberFrom(text){
    const g=text.match(/\bgrade\s*(\d{1,2})\b/i);
    if(g){profile.grade=g[1];localStorage.setItem("smchs_profile",JSON.stringify(profile));}
    const kg=text.match(/\bkg\s*([12])\b/i);
    if(kg){profile.grade=kg[1]==="1"?"KG1":"KG2";localStorage.setItem("smchs_profile",JSON.stringify(profile));}
  }

  async function ask(q){
    addBubble(q,true); rememberFrom(q); input.value=''; input.focus(); showTyping();
    const profileHint = profile.grade ? ` (profile: Grade ${profile.grade})` : '';
    try{
      const res = await fetch(WORKER_URL, {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ question:q+profileHint, kb:KB, history })
      });
      hideTyping();
      if(!res.ok){ addBubble("Sorry, I couldn‚Äôt reach the service. Please try again.", false); return; }
      const data = await res.json();
      addBubble(data.answer || "I don‚Äôt have that in the official info. Please contact the school office.", false);
      history.push({role:"user", content:q});
      history.push({role:"assistant", content:data.answer});
    }catch(e){ hideTyping(); addBubble("Network error. Please try again.", false); }
  }

  form.addEventListener('submit', e=>{e.preventDefault(); const q=input.value.trim(); if(q) ask(q);});
  chips.addEventListener('click', e=>{const btn=e.target.closest('[data-q]'); if(btn) ask(btn.dataset.q);});
  setTimeout(()=>input.focus(),200);
  </script>
</body>
</html>

