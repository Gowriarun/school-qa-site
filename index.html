<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>St. Mary‚Äôs Parent Assistant</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1424;
      --panel:#141b34;
      --ink:#e9edff;
      --ink-dim:#b7bfdd;
      --brand:#6aa6ff;
      --accent:#9aa8ff;
      --chip:#1d2646;
      --you:#3556f0;
      --send:#8fb4ff;
      --radius:18px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:radial-gradient(1200px 1200px at 80% -20%,#1a2452 0%,#0f1424 60%);
      color:var(--ink);font:400 16px/1.5 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      display:flex;align-items:center;justify-content:center;
    }
    .app{
      width:min(980px,100%);
      height:100vh;
      display:flex;flex-direction:column;
    }
    header{
      padding:18px 20px;display:flex;align-items:center;gap:12px;
    }
    .brand{
      font-weight:700;letter-spacing:.2px;
      background:linear-gradient(90deg,#b7c7ff,#6aa6ff 60%,#8bf0ff);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      font-size:20px
    }
    .card{
      background:var(--panel);border-radius:var(--radius);box-shadow:var(--shadow);
      padding:18px 20px;margin:8px 16px;
    }
    .system-welcome{
      margin:12px 16px 4px;border-radius:var(--radius);background:#162048;color:var(--ink);
      padding:18px 20px;box-shadow:var(--shadow);
    }
    .system-welcome .small{color:var(--ink-dim);font-size:14px;margin-top:10px}
    .chat{
      flex:1;overflow:auto;padding:10px 12px 4px 12px;
      scroll-behavior:smooth;
    }
    .msg{max-width:85%;padding:14px 16px;border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.25);margin:10px 8px;white-space:pre-wrap}
    .bot{background:#17204a;color:var(--ink);border-bottom-left-radius:6px}
    .you{background:var(--you);color:#fff;margin-left:auto;border-bottom-right-radius:6px}
    .row{display:flex}
    .dock{
      padding:10px 12px 16px;background:linear-gradient(180deg,transparent,rgba(0,0,0,.25));
      position:sticky;bottom:0;
    }
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin:0 16px 10px}
    .chip{
      border:1px solid rgba(255,255,255,.1);
      background:var(--chip);color:var(--ink);padding:8px 12px;border-radius:999px;
      font-size:14px;cursor:pointer;transition:.15s;user-select:none
    }
    .chip:hover{transform:translateY(-1px);background:#223060}
    form{display:flex;gap:10px;margin:0 16px}
    input[type=text]{
      flex:1;border:none;outline:none;padding:16px 16px;border-radius:12px;
      background:#121a39;color:var(--ink);font-size:16px;
      border:1px solid rgba(255,255,255,.08)
    }
    button{
      border:none;background:var(--send);color:#00122a;font-weight:700;
      padding:0 22px;border-radius:12px;cursor:pointer;box-shadow:var(--shadow);min-width:92px
    }
    button:disabled{filter:grayscale(.5);opacity:.6;cursor:not-allowed}
    .foot{
      text-align:center;color:var(--ink-dim);font-size:12px;margin:6px 0 12px
    }
    @media (max-width:640px){
      .msg{max-width:100%}
      button{min-width:72px}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">St. Mary‚Äôs ‚Ä¢ Parent Assistant</div>
    </header>

    <div class="system-welcome card" id="welcome">
      <div style="font-size:18px"><strong>Hi!</strong> I‚Äôm the St. Mary‚Äôs Parent Assistant üòä</div>
      <div>Ask about <strong>admissions</strong>, <strong>fees</strong>, <strong>subjects</strong>, documents, timings, or policies.</div>
      <div class="small">Try: ‚ÄúDocuments for admission‚Äù, ‚ÄúFees for Grade 11‚Äù, ‚ÄúA‚Äô Level subjects‚Äù, ‚ÄúSchool timings‚Äù.</div>
    </div>

    <main id="chat" class="chat" aria-live="polite"></main>

    <div class="dock">
      <div class="chips" id="chips"></div>
      <form id="form">
        <input id="input" type="text" placeholder="Type your question‚Ä¶" autocomplete="off" />
        <button id="send" type="submit">Send ‚Üó</button>
      </form>
      <div class="foot">Answers are specific to St. Mary‚Äôs Catholic High School, Fujairah.</div>
    </div>
  </div>

  <script>
    const API_URL = "https://YOUR-WORKER-SUBDOMAIN.workers.dev/api/ask"; // <‚Äî replace with your Worker URL
    const chat = document.getElementById('chat');
    const form = document.getElementById('form');
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('send');
    const chips = document.getElementById('chips');

    // session id (persisted)
    const SID_KEY = "smf_parent_sid";
    let sessionId = localStorage.getItem(SID_KEY);
    if(!sessionId){
      sessionId = self.crypto.randomUUID();
      localStorage.setItem(SID_KEY, sessionId);
    }

    const SUGGESTIONS = [
      "Documents for admission",
      "Fees for Grade 11",
      "Subjects for Grade 9",
      "A‚Äô Level subjects",
      "School timings",
      "Parent portal",
      "How to apply",
      "Uniform",
      "Contact details"
    ];
    SUGGESTIONS.forEach(t=>{
      const b=document.createElement('div');
      b.className='chip'; b.textContent=t;
      b.onclick=()=> { input.value=t; form.dispatchEvent(new Event('submit')); };
      chips.appendChild(b);
    });

    function addBubble(text, who="bot"){
      const row = document.createElement('div');
      row.className="row";
      const b = document.createElement('div');
      b.className = `msg ${who==='you'?'you':'bot'}`;
      b.innerText = text;
      row.appendChild(b);
      chat.appendChild(row);
      chat.scrollTop = chat.scrollHeight;
    }

    async function ask(message){
      sendBtn.disabled = true;
      addBubble(message,'you');
      input.value = "";

      try{
        const res = await fetch(API_URL, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ message, sessionId })
        });
        if(!res.ok) throw new Error('Network error');
        const data = await res.json();
        addBubble(data.answer || "Sorry, I couldn't get that just now.");
      }catch(e){
        addBubble("Sorry, I couldn‚Äôt reach the knowledge service just now. Try again in a moment.");
      }finally{
        sendBtn.disabled = false;
        input.focus();
      }
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const text = (input.value||"").trim();
      if(!text) return;
      ask(text);
    });
  </script>
</body>
</html>
